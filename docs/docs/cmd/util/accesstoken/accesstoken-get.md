# util accesstoken get

Gets access token for the specified resource

## Usage

```sh
m365 util accesstoken get [options]
```

## Options

`-r, --resource <resource>`
: The resource for which to retrieve an access token

`--new`
: Retrieve a new access token to ensure that it's valid for as long as possible

--8<-- "docs/cmd/_global.md"

## Remarks

The `util accesstoken get` command returns an access token for the specified resource. If an access token has been previously retrieved and is still valid, the command will return the cached token. If you want to ensure that the returned access token is valid for as long as possible, you can force the command to retrieve a new access token by using the `--new` option.

If the URL of your SharePoint tenant has been previously retrieved, you can use `sharepoint` as the resource to retrieve access token for SharePoint. To verify if the URL of your SharePoint tenant has been previously retrieved, use the [`spo get`](../../spo/spo-get.md) command. To explicitly set the URL of your SharePoint tenant use the [`spo set`](../../spo/spo-set.md) command.

## Examples

Get access token for the Microsoft Graph

```sh
m365 util accesstoken get --resource https://graph.microsoft.com
```

Get access token for SharePoint Online using the shorthand identifier

```sh
m365 util accesstoken get --resource sharepoint
```

Get a new access token for SharePoint Online

```sh
m365 util accesstoken get --resource https://contoso.sharepoint.com --new
```

## Response

=== "JSON"

    ```json
    "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.ewogICJhdWQiOiAiaHR0cHM6Ly9jb250b3NvLnNoYXJlcG9pbnQuY29tIiwKICAiaXNzIjogImh0dHBzOi8vc3RzLndpbmRvd3MubmV0L2VhNjExNDcxLTE2ZTEtNDEwMS1hN2M0LTMzNTNmNjc1YTBkOC8iLAogICJpYXQiOiAxNjY3NTE2MDM1LAogICJuYmYiOiAxNjY3NTE2MDM1LAogICJleHAiOiAxNjY3NTIwODE3LAogICJhY3IiOiAiMSIsCiAgImFpbyI6ICJBVFFBeS84VEFBQUE0NFZrYm45YWNXa3Y1RVIzT1M1R3N3WWxZdzlHRlpvQmtQUG50VHhlTDY4ZDNRUXdheFFlMU01OW1ycnBXOVlFIiwKICAiYW1yIjogWwogICAgInB3ZCIKICBdLAogICJhcHBfZGlzcGxheW5hbWUiOiAiUG5QIE1hbmFnZW1lbnQgU2hlbGwiLAogICJhcHBpZCI6ICIzMTM1OWM3Zi1iZDdlLTQ3NWMtODZkYi1mZGI4YzkzNzU0OGUiLAogICJhcHBpZGFjciI6ICIwIiwKICAiZmFtaWx5X25hbWUiOiAiRG9lIiwKICAiZ2l2ZW5fbmFtZSI6ICJKb2huIiwKICAiaWR0eXAiOiAidXNlciIsCiAgImlwYWRkciI6ICIyMTMuNDkuMTM3LjQ2IiwKICAibmFtZSI6ICJKb2huIERvZSIsCiAgIm9pZCI6ICJiMjA5MWUxOC03ODgyLTRlZmUtYjdkMS05MDcwM2Y1YTVjNjUiLAogICJwdWlkIjogIjEwMDMyMDAwMzJEQTIyQ0EiLAogICJyaCI6ICIwLkFURUFXSmVGOVhveE0wV0hDRVY0SHBnOGFnTUFBQUFBQVBFUHpnQUFBQUFBQUFBeEFIYy4iLAogICJzY3AiOiAiQWxsU2l0ZXMuRnVsbENvbnRyb2wgQXBwQ2F0YWxvZy5SZWFkV3JpdGUuQWxsIEF1ZGl0TG9nLlJlYWQuQWxsIEJvb2tpbmdzLlJlYWQuQWxsIENoYW5uZWxNZW1iZXIuUmVhZFdyaXRlLkFsbCBDaGFubmVsTWVzc2FnZS5SZWFkLkFsbCBDaGFubmVsTWVzc2FnZS5TZW5kIENoYW5uZWxTZXR0aW5ncy5SZWFkV3JpdGUuQWxsIENoYXQuUmVhZCBDaGF0LlJlYWRXcml0ZSBEaXJlY3RvcnkuQWNjZXNzQXNVc2VyLkFsbCBEaXJlY3RvcnkuUmVhZFdyaXRlLkFsbCBFeHRlcm5hbENvbm5lY3Rpb24uUmVhZFdyaXRlLkFsbCBHcm91cC5SZWFkV3JpdGUuQWxsIElkZW50aXR5UHJvdmlkZXIuUmVhZFdyaXRlLkFsbCBNYWlsLlJlYWRXcml0ZSBNYWlsLlNlbmQgTm90ZXMuUmVhZC5BbGwgUGxhY2UuUmVhZC5BbGwgUG9saWN5LlJlYWQuQWxsIFJlcG9ydHMuUmVhZC5BbGwgU2VjdXJpdHlFdmVudHMuUmVhZC5BbGwgU2VydmljZUhlYWx0aC5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZS5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZVZpZXdwb2ludC5Xcml0ZSBUYXNrcy5SZWFkV3JpdGUgVGVhbS5DcmVhdGUgVGVhbU1lbWJlci5SZWFkV3JpdGUuQWxsIFRlYW1zQXBwSW5zdGFsbGF0aW9uLlJlYWRXcml0ZUZvclVzZXIgVGVhbVNldHRpbmdzLlJlYWRXcml0ZS5BbGwgVGVhbXNUYWIuUmVhZFdyaXRlLkFsbCBUZXJtU3RvcmUuUmVhZFdyaXRlLkFsbCBVc2VyLkludml0ZS5BbGwgVXNlci5SZWFkV3JpdGUuQWxsIiwKICAic2lkIjogImQwNzE4ZmE2LTYyYzAtNDExYi04YTFjLTIyNjdhNWM5N2VkNSIsCiAgInNpZ25pbl9zdGF0ZSI6IFsKICAgICJrbXNpIgogIF0sCiAgInN1YiI6ICJCdFhiMVdVdmIzOVp6UXoyd2tTenozZnZ5emFwSFl5b1dlRHlhNzF2S3ZRIiwKICAidGlkIjogImVhNjExNDcxLTE2ZTEtNDEwMS1hN2M0LTMzNTNmNjc1YTBkOCIsCiAgInVuaXF1ZV9uYW1lIjogImpvaG4uZG9lQGNvbnRvc28ub25taWNyb3NvZnQuY29tIiwKICAidXBuIjogImpvaG4uZG9lQGNvbnRvc28ub25taWNyb3NvZnQuY29tIiwKICAidXRpIjogIjdvdDQ4UjhlQmttbk5QTnpGM1F3QUEiLAogICJ2ZXIiOiAiMS4wIiwKICAid2lkcyI6IFsKICAgICI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLAogICAgImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSIKICBdCn0=.Y6yWiwlla_qNGKjePmkLsF8Oq0ZFK3ujk8eHixwtHIyus5g1ojbo7K-1lgExXrKGAp59YGLIKWoU7t-LeblKrdB35QHGjRoiQk0VaomE75iX9k-if_5D98h2N6t9WwSHGQcBj3lMonG4lmQfNV5hmBx9xFwJtCkbInaFRmoLZPBCcAFKrLRzE6LjdecXaBnGtxucWKsVOZVc6RRLTvWNpKbQLuJ3azremB77qZ49BxtuVLCgYzYsf8a14mJhMlEN4_m6mPjhdmElcr8JSe6EZRxrGlKMhUhkhc4zhjkQ_nDHqzXkin80FUbyX1y5U4r71KUJvtn5bqxeDK20DQD6mQ"
    ```

=== "Text"

    ```text
    eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.ewogICJhdWQiOiAiaHR0cHM6Ly9jb250b3NvLnNoYXJlcG9pbnQuY29tIiwKICAiaXNzIjogImh0dHBzOi8vc3RzLndpbmRvd3MubmV0L2VhNjExNDcxLTE2ZTEtNDEwMS1hN2M0LTMzNTNmNjc1YTBkOC8iLAogICJpYXQiOiAxNjY3NTE2MDM1LAogICJuYmYiOiAxNjY3NTE2MDM1LAogICJleHAiOiAxNjY3NTIwODE3LAogICJhY3IiOiAiMSIsCiAgImFpbyI6ICJBVFFBeS84VEFBQUE0NFZrYm45YWNXa3Y1RVIzT1M1R3N3WWxZdzlHRlpvQmtQUG50VHhlTDY4ZDNRUXdheFFlMU01OW1ycnBXOVlFIiwKICAiYW1yIjogWwogICAgInB3ZCIKICBdLAogICJhcHBfZGlzcGxheW5hbWUiOiAiUG5QIE1hbmFnZW1lbnQgU2hlbGwiLAogICJhcHBpZCI6ICIzMTM1OWM3Zi1iZDdlLTQ3NWMtODZkYi1mZGI4YzkzNzU0OGUiLAogICJhcHBpZGFjciI6ICIwIiwKICAiZmFtaWx5X25hbWUiOiAiRG9lIiwKICAiZ2l2ZW5fbmFtZSI6ICJKb2huIiwKICAiaWR0eXAiOiAidXNlciIsCiAgImlwYWRkciI6ICIyMTMuNDkuMTM3LjQ2IiwKICAibmFtZSI6ICJKb2huIERvZSIsCiAgIm9pZCI6ICJiMjA5MWUxOC03ODgyLTRlZmUtYjdkMS05MDcwM2Y1YTVjNjUiLAogICJwdWlkIjogIjEwMDMyMDAwMzJEQTIyQ0EiLAogICJyaCI6ICIwLkFURUFXSmVGOVhveE0wV0hDRVY0SHBnOGFnTUFBQUFBQVBFUHpnQUFBQUFBQUFBeEFIYy4iLAogICJzY3AiOiAiQWxsU2l0ZXMuRnVsbENvbnRyb2wgQXBwQ2F0YWxvZy5SZWFkV3JpdGUuQWxsIEF1ZGl0TG9nLlJlYWQuQWxsIEJvb2tpbmdzLlJlYWQuQWxsIENoYW5uZWxNZW1iZXIuUmVhZFdyaXRlLkFsbCBDaGFubmVsTWVzc2FnZS5SZWFkLkFsbCBDaGFubmVsTWVzc2FnZS5TZW5kIENoYW5uZWxTZXR0aW5ncy5SZWFkV3JpdGUuQWxsIENoYXQuUmVhZCBDaGF0LlJlYWRXcml0ZSBEaXJlY3RvcnkuQWNjZXNzQXNVc2VyLkFsbCBEaXJlY3RvcnkuUmVhZFdyaXRlLkFsbCBFeHRlcm5hbENvbm5lY3Rpb24uUmVhZFdyaXRlLkFsbCBHcm91cC5SZWFkV3JpdGUuQWxsIElkZW50aXR5UHJvdmlkZXIuUmVhZFdyaXRlLkFsbCBNYWlsLlJlYWRXcml0ZSBNYWlsLlNlbmQgTm90ZXMuUmVhZC5BbGwgUGxhY2UuUmVhZC5BbGwgUG9saWN5LlJlYWQuQWxsIFJlcG9ydHMuUmVhZC5BbGwgU2VjdXJpdHlFdmVudHMuUmVhZC5BbGwgU2VydmljZUhlYWx0aC5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZS5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZVZpZXdwb2ludC5Xcml0ZSBUYXNrcy5SZWFkV3JpdGUgVGVhbS5DcmVhdGUgVGVhbU1lbWJlci5SZWFkV3JpdGUuQWxsIFRlYW1zQXBwSW5zdGFsbGF0aW9uLlJlYWRXcml0ZUZvclVzZXIgVGVhbVNldHRpbmdzLlJlYWRXcml0ZS5BbGwgVGVhbXNUYWIuUmVhZFdyaXRlLkFsbCBUZXJtU3RvcmUuUmVhZFdyaXRlLkFsbCBVc2VyLkludml0ZS5BbGwgVXNlci5SZWFkV3JpdGUuQWxsIiwKICAic2lkIjogImQwNzE4ZmE2LTYyYzAtNDExYi04YTFjLTIyNjdhNWM5N2VkNSIsCiAgInNpZ25pbl9zdGF0ZSI6IFsKICAgICJrbXNpIgogIF0sCiAgInN1YiI6ICJCdFhiMVdVdmIzOVp6UXoyd2tTenozZnZ5emFwSFl5b1dlRHlhNzF2S3ZRIiwKICAidGlkIjogImVhNjExNDcxLTE2ZTEtNDEwMS1hN2M0LTMzNTNmNjc1YTBkOCIsCiAgInVuaXF1ZV9uYW1lIjogImpvaG4uZG9lQGNvbnRvc28ub25taWNyb3NvZnQuY29tIiwKICAidXBuIjogImpvaG4uZG9lQGNvbnRvc28ub25taWNyb3NvZnQuY29tIiwKICAidXRpIjogIjdvdDQ4UjhlQmttbk5QTnpGM1F3QUEiLAogICJ2ZXIiOiAiMS4wIiwKICAid2lkcyI6IFsKICAgICI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLAogICAgImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSIKICBdCn0=.Y6yWiwlla_qNGKjePmkLsF8Oq0ZFK3ujk8eHixwtHIyus5g1ojbo7K-1lgExXrKGAp59YGLIKWoU7t-LeblKrdB35QHGjRoiQk0VaomE75iX9k-if_5D98h2N6t9WwSHGQcBj3lMonG4lmQfNV5hmBx9xFwJtCkbInaFRmoLZPBCcAFKrLRzE6LjdecXaBnGtxucWKsVOZVc6RRLTvWNpKbQLuJ3azremB77qZ49BxtuVLCgYzYsf8a14mJhMlEN4_m6mPjhdmElcr8JSe6EZRxrGlKMhUhkhc4zhjkQ_nDHqzXkin80FUbyX1y5U4r71KUJvtn5bqxeDK20DQD6mQ
    ```

=== "CSV"

    ```csv
    eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.ewogICJhdWQiOiAiaHR0cHM6Ly9jb250b3NvLnNoYXJlcG9pbnQuY29tIiwKICAiaXNzIjogImh0dHBzOi8vc3RzLndpbmRvd3MubmV0L2VhNjExNDcxLTE2ZTEtNDEwMS1hN2M0LTMzNTNmNjc1YTBkOC8iLAogICJpYXQiOiAxNjY3NTE2MDM1LAogICJuYmYiOiAxNjY3NTE2MDM1LAogICJleHAiOiAxNjY3NTIwODE3LAogICJhY3IiOiAiMSIsCiAgImFpbyI6ICJBVFFBeS84VEFBQUE0NFZrYm45YWNXa3Y1RVIzT1M1R3N3WWxZdzlHRlpvQmtQUG50VHhlTDY4ZDNRUXdheFFlMU01OW1ycnBXOVlFIiwKICAiYW1yIjogWwogICAgInB3ZCIKICBdLAogICJhcHBfZGlzcGxheW5hbWUiOiAiUG5QIE1hbmFnZW1lbnQgU2hlbGwiLAogICJhcHBpZCI6ICIzMTM1OWM3Zi1iZDdlLTQ3NWMtODZkYi1mZGI4YzkzNzU0OGUiLAogICJhcHBpZGFjciI6ICIwIiwKICAiZmFtaWx5X25hbWUiOiAiRG9lIiwKICAiZ2l2ZW5fbmFtZSI6ICJKb2huIiwKICAiaWR0eXAiOiAidXNlciIsCiAgImlwYWRkciI6ICIyMTMuNDkuMTM3LjQ2IiwKICAibmFtZSI6ICJKb2huIERvZSIsCiAgIm9pZCI6ICJiMjA5MWUxOC03ODgyLTRlZmUtYjdkMS05MDcwM2Y1YTVjNjUiLAogICJwdWlkIjogIjEwMDMyMDAwMzJEQTIyQ0EiLAogICJyaCI6ICIwLkFURUFXSmVGOVhveE0wV0hDRVY0SHBnOGFnTUFBQUFBQVBFUHpnQUFBQUFBQUFBeEFIYy4iLAogICJzY3AiOiAiQWxsU2l0ZXMuRnVsbENvbnRyb2wgQXBwQ2F0YWxvZy5SZWFkV3JpdGUuQWxsIEF1ZGl0TG9nLlJlYWQuQWxsIEJvb2tpbmdzLlJlYWQuQWxsIENoYW5uZWxNZW1iZXIuUmVhZFdyaXRlLkFsbCBDaGFubmVsTWVzc2FnZS5SZWFkLkFsbCBDaGFubmVsTWVzc2FnZS5TZW5kIENoYW5uZWxTZXR0aW5ncy5SZWFkV3JpdGUuQWxsIENoYXQuUmVhZCBDaGF0LlJlYWRXcml0ZSBEaXJlY3RvcnkuQWNjZXNzQXNVc2VyLkFsbCBEaXJlY3RvcnkuUmVhZFdyaXRlLkFsbCBFeHRlcm5hbENvbm5lY3Rpb24uUmVhZFdyaXRlLkFsbCBHcm91cC5SZWFkV3JpdGUuQWxsIElkZW50aXR5UHJvdmlkZXIuUmVhZFdyaXRlLkFsbCBNYWlsLlJlYWRXcml0ZSBNYWlsLlNlbmQgTm90ZXMuUmVhZC5BbGwgUGxhY2UuUmVhZC5BbGwgUG9saWN5LlJlYWQuQWxsIFJlcG9ydHMuUmVhZC5BbGwgU2VjdXJpdHlFdmVudHMuUmVhZC5BbGwgU2VydmljZUhlYWx0aC5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZS5SZWFkLkFsbCBTZXJ2aWNlTWVzc2FnZVZpZXdwb2ludC5Xcml0ZSBUYXNrcy5SZWFkV3JpdGUgVGVhbS5DcmVhdGUgVGVhbU1lbWJlci5SZWFkV3JpdGUuQWxsIFRlYW1zQXBwSW5zdGFsbGF0aW9uLlJlYWRXcml0ZUZvclVzZXIgVGVhbVNldHRpbmdzLlJlYWRXcml0ZS5BbGwgVGVhbXNUYWIuUmVhZFdyaXRlLkFsbCBUZXJtU3RvcmUuUmVhZFdyaXRlLkFsbCBVc2VyLkludml0ZS5BbGwgVXNlci5SZWFkV3JpdGUuQWxsIiwKICAic2lkIjogImQwNzE4ZmE2LTYyYzAtNDExYi04YTFjLTIyNjdhNWM5N2VkNSIsCiAgInNpZ25pbl9zdGF0ZSI6IFsKICAgICJrbXNpIgogIF0sCiAgInN1YiI6ICJCdFhiMVdVdmIzOVp6UXoyd2tTenozZnZ5emFwSFl5b1dlRHlhNzF2S3ZRIiwKICAidGlkIjogImVhNjExNDcxLTE2ZTEtNDEwMS1hN2M0LTMzNTNmNjc1YTBkOCIsCiAgInVuaXF1ZV9uYW1lIjogImpvaG4uZG9lQGNvbnRvc28ub25taWNyb3NvZnQuY29tIiwKICAidXBuIjogImpvaG4uZG9lQGNvbnRvc28ub25taWNyb3NvZnQuY29tIiwKICAidXRpIjogIjdvdDQ4UjhlQmttbk5QTnpGM1F3QUEiLAogICJ2ZXIiOiAiMS4wIiwKICAid2lkcyI6IFsKICAgICI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLAogICAgImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSIKICBdCn0=.Y6yWiwlla_qNGKjePmkLsF8Oq0ZFK3ujk8eHixwtHIyus5g1ojbo7K-1lgExXrKGAp59YGLIKWoU7t-LeblKrdB35QHGjRoiQk0VaomE75iX9k-if_5D98h2N6t9WwSHGQcBj3lMonG4lmQfNV5hmBx9xFwJtCkbInaFRmoLZPBCcAFKrLRzE6LjdecXaBnGtxucWKsVOZVc6RRLTvWNpKbQLuJ3azremB77qZ49BxtuVLCgYzYsf8a14mJhMlEN4_m6mPjhdmElcr8JSe6EZRxrGlKMhUhkhc4zhjkQ_nDHqzXkin80FUbyX1y5U4r71KUJvtn5bqxeDK20DQD6mQ
    ```
