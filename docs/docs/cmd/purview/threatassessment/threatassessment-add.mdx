import Global from '/docs/cmd/_global.mdx';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# purview threatassessment add

Create a threat assessment

## Usage

```sh
m365 purview threatassessment add [options]
```

## Options

```md definition-list
`-t, --type <type>`
: The type of threat assessment to add. Supports `mail`, `file`, `emailFile` and `url`.

`-e, --expectedAssessment <expectedAssessment>`
: The expected assessment from submitter. Possible values are: `block` and `unblock`.

`-c, --category <category>`
: The threat category. Possible values are: `spam`, `phishing`, `malware`.

`-r, --recipientEmail [recipientEmail]`
: The mail recipient whose policies are used to assess the mail. Can only be used for a threat assessment with type `mail` and `emailFile`.

`-p, --path [path]`
: Local path to the file to upload. Can only be used for a threat assessment with type `file` and `emailFile`.

`-u, --url [url]`
: The URL string. Can only be used for a threat assessment with type `url`.

`-m, --messageUri [messageUri]`
: The resource URI of the mail message for assessment. Can only be used for a threat assessment with type `mail`.
```

<Global />

## Remarks

:::caution
    
This command currently only supports delegated permissions.

:::

## Examples

Create a mail threat assessment

```sh
m365 purview threatassessment add --type mail --expectedAssessment block --recipientEmail 'john.doe@contoso.com' --category spam --messageUri 'https://graph.microsoft.com/v1.0/users/c52ce8db-3e4b-4181-93c4-7d6b6bffaf60/messages/AAMkADU3MWUxOTU0LWNlOTEt='
```

Create an emailFile threat assessment

```sh
m365 purview threatassessment add --type emailFile --expectedAssessment block --category malware --recipientEmail 'john.doe@contoso.com' --path 'C:\Path\To\File.txt'
```

Create a file threat assessment

```sh
m365 purview threatassessment add --type file --expectedAssessment block --category malware --fileName 'test.txt' --path 'C:\Path\To\File.txt'
```

Create a url threat assessment

```sh
m365 purview threatassessment add --type url --expectedAssessment block --category phishing --url 'http://contoso.com'
```

## Response

<Tabs>
  <TabItem value="JSON">

  ```json
  {
    "id": "8aaba0ac-ec4d-4e62-5774-08db16c68731",
    "createdDateTime": "2023-02-25T00:23:33.0550644Z",
    "contentType": "mail",
    "expectedAssessment": "block",
    "category": "spam",
    "status": "pending",
    "requestSource": "administrator",
    "recipientEmail": "john@contoso.com",
    "destinationRoutingReason": "notJunk",
    "messageUri": "https://graph.microsoft.com/v1.0/users/john@contoso.com/messages/AAMkADgzN2Q1NThiLTI0NjYtNGIxYS05MDdjLTg1OWQxNzgwZGM2ZgBGAAAAAAC6jQfUzacTSIHqMw2yacnUBwBiOC8xvYmdT6G2E_hLMK5kAAAAAAEMAABiOC8xvYmdT6G2E_hLMK5kAALHNaMuAAA=",
    "createdBy": {
      "user": {
        "id": "fe36f75e-c103-410b-a18a-2bf6df06ac3a",
        "displayName": "John Doe"
      }
    }
  }
  ```
  
  </TabItem>

  <TabItem value="Text">

  ```text
  category                : spam
  contentType             : mail
  createdBy               : {"user":{"id":"fe36f75e-c103-410b-a18a-2bf6df06ac3a","displayName":"John Doe"}}
  createdDateTime         : 2023-02-25T00:23:33.0550644Z
  destinationRoutingReason: notJunk
  expectedAssessment      : block
  id                      : 8aaba0ac-ec4d-4e62-5774-08db16c68731
  messageUri              : https://graph.microsoft.com/v1.0/users/john@contoso.com/messages/AAMkADgzN2Q1NThiLTI0NjYtNGIxYS05MDdjLTg1OWQxNzgwZGM2ZgBGAAAAAAC6jQfUzacTSIHqMw2yacnUBwBiOC8xvYmdT6G2E_hLMK5kAAAAAAEMAABiOC8xvYmdT6G2E_hLMK5kAALHNaMuAAA=
  recipientEmail          : john@contoso.com
  requestSource           : administrator
  status                  : pending
  ```

  </TabItem>

  <TabItem value="CSV">

  ```csv
  id,createdDateTime,contentType,expectedAssessment,category,status,requestSource,recipientEmail,destinationRoutingReason,messageUri,createdBy
  8aaba0ac-ec4d-4e62-5774-08db16c68731,2023-02-25T00:23:33.0550644Z,mail,block,spam,pending,administrator,john@contoso.com,notJunk,https://graph.microsoft.com/v1.0/users/john@contoso.com/messages/AAMkADgzN2Q1NThiLTI0NjYtNGIxYS05MDdjLTg1OWQxNzgwZGM2ZgBGAAAAAAC6jQfUzacTSIHqMw2yacnUBwBiOC8xvYmdT6G2E_hLMK5kAAAAAAEMAABiOC8xvYmdT6G2E_hLMK5kAALHNaMuAAA=,"{""user"":{""id"":""fe36f75e-c103-410b-a18a-2bf6df06ac3a"",""displayName"":""John Doe""}}"
  ```

  </TabItem>

  <TabItem value="Markdown">

  ```md
  # m365 purview threatassessment add --type mail --expectedAssessment block --recipientEmail 'john.doe@contoso.com' --category spam --messageUri 'https://graph.microsoft.com/v1.0/users/c52ce8db-3e4b-4181-93c4-7d6b6bffaf60/messages/AAMkADU3MWUxOTU0LWNlOTEt='

  Date: 19/05/2023

  ## 8aaba0ac-ec4d-4e62-5774-08db16c68731

  Property | Value
  ---------|-------
  id | 8aaba0ac-ec4d-4e62-5774-08db16c68731
  createdDateTime | 2023-02-25T00:23:33.0550644Z
  contentType | mail
  expectedAssessment | block
  category | spam
  status | pending
  requestSource | administrator
  recipientEmail | john@contoso.com
  destinationRoutingReason | notJunk
  messageUri | https://graph.microsoft.com/v1.0/users/john@contoso.com/messages/AAMkADgzN2Q1NThiLTI0NjYtNGIxYS05MDdjLTg1OWQxNzgwZGM2ZgBGAAAAAAC6jQfUzacTSIHqMw2yacnUBwBiOC8xvYmdT6G2E\_hLMK5kAAAAAAEMAABiOC8xvYmdT6G2E\_hLMK5kAALHNaMuAAA=
  createdBy | {"user":{"id":"fe36f75e-c103-410b-a18a-2bf6df06ac3a","displayName":"John Doe"}}
  ```
  
  </TabItem>
</Tabs>
