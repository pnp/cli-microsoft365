import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# v11 Upgrade Guidance

The v11 release of CLI for Microsoft 365 introduces several breaking changes. To assist you in upgrading to the latest version, we've outlined the changes and the actions you may need to take.

## SharePoint

### `spo homesite set` no longer adds new home sites

The [spo homesite set](./cmd/spo/homesite/homesite-set.mdx) command has been updated to only modify existing home sites. It will no longer add a new site as home site if you don't have any configured yet.

#### What action do I need to take?

- **For adding new home sites**: Use the new [spo homesite add](./cmd/spo/homesite/homesite-add.mdx) command instead
- **For updating existing home sites**: Continue using [spo homesite set](./cmd/spo/homesite/homesite-set.mdx) as before with required option `siteUrl`.

### `spo list view add` default paged option changed

The [spo list view add](./cmd/spo/list/list-view-add.mdx) command has been updated to change the default value of the `paged` option from `false` to `true`. This change reflects the common usage pattern where most views allow paging and fetch new items while scrolling down.

#### What action do I need to take?

- **If you want paged views (most common)**: No action required as this is now the default behavior
- **If you want static views**: Explicitly specify `--paged false` when creating views that should not fetch new items while scrolling

## Teams

### Ensure list output for `teams report` commands

We noticed that some of the `list` commands were not returning an array, but an object with a `value` property. We've updated those commands to return an array of items.

<details>
  <summary>Click here to compare the different command outputs of an affected command</summary>

<Tabs>
  <TabItem value="v10 output">

  ```json
  {
    "@odata.count": 1,
    "value": [
      {
        "id": "9e8bba57-dc14-533a-a7dd-f0da6575eed1",
        "correlationId": "c98e1515-a937-4b81-b8a8-3992afde64e0",
        "userId": "db03c14b-06eb-4189-939b-7cbf3a20ba27",
        "userPrincipalName": "richard.malk@contoso.com",
        "userDisplayName": "Richard Malk",
        "startDateTime": "2019-11-01T00:00:25.105Z",
        "inviteDateTime": "2019-11-01T00:00:21.949Z",
        "failureDateTime": "0001-01-01T00:00:00Z",
        "endDateTime": "2019-11-01T00:00:30.105Z",
        "duration": 5,
        "callType": "ByotIn",
        "successfulCall": true,
        "callerNumber": "+12345678***",
        "calleeNumber": "+01234567***",
        "mediaPathLocation": "USWE",
        "signalingLocation": "EUNO",
        "finalSipCode": 0,
        "callEndSubReason": 540000,
        "finalSipCodePhrase": "BYE",
        "trunkFullyQualifiedDomainName": "tll-audiocodes01.adatum.biz",
        "mediaBypassEnabled": false
      }
    ]
  }
  ```

  </TabItem>
  <TabItem value="v11 output">

  ```json
  [
    {
      "id": "9e8bba57-dc14-533a-a7dd-f0da6575eed1",
      "correlationId": "c98e1515-a937-4b81-b8a8-3992afde64e0",
      "userId": "db03c14b-06eb-4189-939b-7cbf3a20ba27",
      "userPrincipalName": "richard.malk@contoso.com",
      "userDisplayName": "Richard Malk",
      "startDateTime": "2019-11-01T00:00:25.105Z",
      "inviteDateTime": "2019-11-01T00:00:21.949Z",
      "failureDateTime": "0001-01-01T00:00:00Z",
      "endDateTime": "2019-11-01T00:00:30.105Z",
      "duration": 5,
      "callType": "ByotIn",
      "successfulCall": true,
      "callerNumber": "+12345678***",
      "calleeNumber": "+01234567***",
      "mediaPathLocation": "USWE",
      "signalingLocation": "EUNO",
      "finalSipCode": 0,
      "callEndSubReason": 540000,
      "finalSipCodePhrase": "BYE",
      "trunkFullyQualifiedDomainName": "tll-audiocodes01.adatum.biz",
      "mediaBypassEnabled": false
    }
  ]
  ```

  </TabItem>
</Tabs>
</details>

The commands impacted by this change are:

- [teams report directroutingcalls](./cmd/teams/report/report-directroutingcalls.mdx)
- [teams report pstncalls](./cmd/teams/report/report-pstncalls.mdx)

#### What action do I need to take?

Update your scripts to expect an array of items.


## General

### Ensured output for `list` commands

We noticed that some of the `list` commands were not returning any output when no items were found. We've updated all `list` commands to return an empty array when no items are found.

The commands impacted by this change are:

- [spo customaction list](./cmd/spo/customaction/customaction-list.mdx)

#### What action do I need to take?

Update your scripts to expect an empty array when no items are found.

### Removed commands

Some commands were removed because their API endpoint became deprecated or the product began an end-of-life phase.

Read the documentation for alternative commands to find out how to use them and what permissions are required.

Command | Alternative
--- | ---
`pp card clone` | None
`pp card get` | None
`pp card list` | None
`pp card remove` | None
`spo mail send` | [outlook mail send](./cmd/outlook/mail/mail-send.mdx)
`skype report activitycounts` | None
`skype report activityusercounts` | None
`skype report activityuserdetail` | None
`viva engage group list` | [viva engage community list](./cmd/viva/engage/engage-community-list.mdx)
`viva engage group user add` | [viva engage community user add](./cmd/viva/engage/engage-community-user-add.mdx)
`viva engage group user remove` | [viva engage community user remove](./cmd/viva/engage/engage-community-user-remove.mdx)
